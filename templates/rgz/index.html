<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ò–Ω–∏—Ü–∏–∞—Ç–∏–≤—ã</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>
    <div class="header">
        –ù–µ—Å—Ç–µ—Ä–µ–Ω–∫–æ –ò—Ä–∏–Ω–∞
    </div>
    <h1>–°–ø–∏—Å–æ–∫ –∏–Ω–∏—Ü–∏–∞—Ç–∏–≤</h1>

    {% if error %}
        <p style="color: red;">{{ error }}</p>
    {% endif %}

    {% if session.get('user_id') %}
        <!-- –ö–Ω–æ–ø–∫–∞ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –Ω–æ–≤–æ–π –∏–Ω–∏—Ü–∏–∞—Ç–∏–≤—ã (–≤–∏–¥–Ω–∞ —Ç–æ–ª—å–∫–æ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º) -->
        <a href="{{ url_for('rgz.create_initiative') }}">
            <button>–°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—É—é –∏–Ω–∏—Ü–∏–∞—Ç–∏–≤—É</button>
        </a>
        
        <!-- –ö–Ω–æ–ø–∫–∞ –¥–ª—è –≤—ã—Ö–æ–¥–∞ –∏–∑ –∞–∫–∫–∞—É–Ω—Ç–∞ -->
        <a href="{{ url_for('rgz.logout') }}">
            <button>–í—ã–π—Ç–∏</button>
        </a>
    {% else %}
        <!-- –ï—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω, –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –∫–Ω–æ–ø–∫—É –¥–ª—è –≤—Ö–æ–¥–∞ –∏–ª–∏ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ -->
        <div class="auth-links">
            <a href="{{ url_for('rgz.register') }}">
                <button>–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è</button>
            </a>
            <a href="{{ url_for('rgz.login') }}">
                <button>–í–æ–π—Ç–∏</button>
            </a>
        </div>
    {% endif %}

    {% if initiatives %}
        <ul>
            {% for initiative in initiatives %}
            <div class="initiative-card">
                <h3>{{ initiative.title }}</h3>
                <p>{{ initiative.description }}</p>
                <p><strong>–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è:</strong> {{ initiative.created_at }}</p>
                <p><strong>–û—Ü–µ–Ω–∫–∞:</strong> {{ initiative.rating }}</p>

                {% if session['user_id'] == initiative.user_id %}
                    <form action="{{ url_for('rgz.delete_initiative', initiative_id=initiative.id) }}" method="post">
                        <button type="submit">–£–¥–∞–ª–∏—Ç—å</button>
                    </form>
                {% endif %}

                <!-- –§–æ—Ä–º–∞ –¥–ª—è –≥–æ–ª–æ—Å–æ–≤–∞–Ω–∏—è -->
                <!-- –ö–Ω–æ–ø–∫–∞ "–ì–æ–ª–æ—Å–æ–≤–∞—Ç—å –∑–∞" -->
                    <form action="{{ url_for('rgz.vote_initiative', initiative_id=initiative.id, vote_type='up') }}" method="post">
                        <button type="submit">üëç –ì–æ–ª–æ—Å–æ–≤–∞—Ç—å –∑–∞</button>
                    </form>

                    <!-- –ö–Ω–æ–ø–∫–∞ "–ì–æ–ª–æ—Å–æ–≤–∞—Ç—å –ø—Ä–æ—Ç–∏–≤" -->
                    <form action="{{ url_for('rgz.vote_initiative', initiative_id=initiative.id, vote_type='down') }}" method="post">
                        <button type="submit">üëé –ì–æ–ª–æ—Å–æ–≤–∞—Ç—å –ø—Ä–æ—Ç–∏–≤</button>
                    </form>

            
                </form>
            </div>
        {% endfor %}

        </ul>

        <!-- –ü–∞–≥–∏–Ω–∞—Ü–∏—è -->
        <div class="pagination">
            {% if page > 1 %}
                <a href="{{ url_for('rgz.index', page=page - 1) }}">¬´ –ü—Ä–µ–¥—ã–¥—É—â–∞—è</a>
            {% endif %}
            {% if page < total_pages %}
                <a href="{{ url_for('rgz.index', page=page + 1) }}">–°–ª–µ–¥—É—é—â–∞—è ¬ª</a>
            {% endif %}
        </div>

        <!-- –ö–Ω–æ–ø–∫–∞ –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ —Å–ª–µ–¥—É—é—â–∏—Ö –∏–Ω–∏—Ü–∏–∞—Ç–∏–≤ -->
        {% if page < total_pages %}
            <a href="{{ url_for('rgz.index', page=page + 1) }}">–ó–∞–≥—Ä—É–∑–∏—Ç—å –±–æ–ª—å—à–µ –∏–Ω–∏—Ü–∏–∞—Ç–∏–≤</a>
        {% endif %}

    {% else %}
        <p>–ù–µ—Ç –∏–Ω–∏—Ü–∏–∞—Ç–∏–≤ –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è.</p>
    {% endif %}
</body>
</html>
